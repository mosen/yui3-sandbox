YUI.add("gallery-dp-appextras",function(a){function b(){}function c(){}function d(){}function e(){}function f(){}b._tId=null,b.ATTRS={loading:{value:!1,validator:a.Lang.isBoolean},uriController:{value:"model"},fnResponseIsError:{value:function(){return!1}},TEMPLATE_URI_CREATE:{value:"/{model}/create.json"},TEMPLATE_URI_READ:{value:"/{model}/view.json?id={id}"},TEMPLATE_URI_UPDATE:{value:"/{model}/update.json?id={id}"},TEMPLATE_URI_DELETE:{value:"/{model}/delete.json?id={id}"}},b.prototype={_fnSetLoading:function(){this.set("loading",!0)},_fnSetNotLoading:function(){this.set("loading",!1)},sync:function(b,c,d){switch(b){case"create":var e=a.Lang.sub(this.get("TEMPLATE_URI_CREATE"),{model:this.get("uriController")});this._tId=a.io(e,{method:"POST",data:this.toPostData(),on:{success:function(a,b,c){this.get("fnResponseIsError")(b)?d("Server sent an error response"):d(null,b)},failure:function(a,b,c){d("Error creating the object (transport error)")},start:this._fnSetLoading,complete:this._fnSetNotLoading},context:this});break;case"read":var f=a.Lang.sub(this.get("TEMPLATE_URI_READ"),{id:this.get("id"),model:this.get("uriController")});this._tId=a.io(f,{method:"GET",on:{success:function(a,b,c){this.get("fnResponseIsError")(b)?d("Server sent an error response"):d(null,b)},failure:function(a,b,c){d("Error retrieving the object (transport error)")},start:this._fnSetLoading,complete:this._fnSetNotLoading},context:this});break;case"update":var g=a.Lang.sub(this.get("TEMPLATE_URI_UPDATE"),{id:this.get("id"),model:this.get("uriController")});this._tId=a.io(g,{method:"POST",data:this.toPostData(),on:{success:function(a,b,c){this.get("fnResponseIsError")(b)?d("Server sent an error response"):d(null,b)},failure:function(a,b,c){d("Error updating the object (transport error)")},start:this._fnSetLoading,complete:this._fnSetNotLoading},context:this});break;case"delete":var h=a.Lang.sub(this.get("TEMPLATE_URI_DELETE"),{id:this.get("id"),model:this.get("uriController")});this._tId=a.io(h,{method:"GET",on:{success:function(a,b,c){this.get("fnResponseIsError")(b)?d("Server sent an error response"):d(null,b)},failure:function(a,b,c){d("Error deleting the object (transport error)")},start:this._fnSetLoading,complete:this._fnSetNotLoading},context:this});break;default:d("invalid action")}}},a.namespace("DP").XHRSyncLayer=b,c.ATTRS={cakeModel:{value:"Model"},cakeAttrs:{value:[]}},c.prototype={toCakePhpData:function(b){var c="data["+this.get("cakeModel")+"]",d=this.get("cakeAttrs"),e={};return b!==undefined&&(d=a.Array.filter(b,function(a){return d.indexOf(a)>-1},this)),a.Lang.isValue(this.get("id"))&&(e[c+"[id]"]=this.get("id")),a.Array.each(d,function(a){e[c+"["+a+"]"]=this.get(a)},this),e},parseCakePhpJSONData:function(b){var c=a.JSON.parse(b.responseText);if(c.response.error===!0)this.fire("error",{type:"parse",error:"Server side error"});else{if(c.response.items.length>0){var d=c.response.items[0][this.get("cakeModel")];return d}return null}}},a.namespace("DP").CakePhpLayer=c,d._tId=null,d.ATTRS={loading:{value:!1,validator:a.Lang.isBoolean},uriController:{value:"model"},TEMPLATE_URI_READ:{value:"/{model}/index.json"}},d.prototype={_fnSetLoading:function(){this.set("loading",!0)},_fnSetNotLoading:function(){this.set("loading",!1)},sync:function(b,c,d){var e;switch(b){case"read":var f=this.getAttrs(),g=a.Lang.sub(this.get("TEMPLATE_URI_READ"),a.mix({model:this.get("uriController")},f));this._tId=a.io(g,{method:"GET",on:{success:function(a,b,c){d(null,b)},failure:function(a,b,c){d("Error retrieving the list")},start:this._fnSetLoading,complete:this._fnSetNotLoading},context:this});break;default:d("invalid action")}}},a.namespace("DP").XHRSyncListLayer=d,e.ATTRS={cakeModel:{value:"Model"}},e.prototype={parseCakePhpJSONData:function(b){var c=a.JSON.parse(b.responseText);if(c.response.error===!0)this.fire("error",{type:"parse",error:"Server side error"});else{var d=c.response.items,e=[],f=this.get("cakeModel");return e=a.Array.map(d,function(a){return a[f]}),e}}},a.namespace("DP").CakePhpListLayer=e,f._tId=null,f.ATTRS={loading:{value:!1,validator:a.Lang.isBoolean},uriController:{value:"model"},TEMPLATE_URI_UPDATE_MANY:{value:"/{model}/update_all.json"}},f.prototype={_fnSetLoading:function(){this.set("loading",!0)},_fnSetNotLoading:function(){this.set("loading",!1)},syncAttrs:function(b,c){var d=a.Lang.sub(this.get("TEMPLATE_URI_UPDATE_MANY"),{model:this.get("uriController")}),c=c||function(a,b){};this._tId=a.io(d,{method:"POST",data:{json:a.JSON.stringify(b.values)},on:{success:function(a,b,d){c(null,b)},failure:function(a,b,d){c("Error updating the objects")},start:this._fnSetLoading,complete:this._fnSetNotLoading},context:this})}},a.namespace("DP").ModelListSyncAttrs=f;var g=" ",h="-",i=":";a.namespace("DP").ModelAccessors={_attrSetterDate:function(b){if(b===null||b===undefined)return null;if(a.Lang.isDate(b))return b;if(b!==null&&b.match(/[0-9]{4}-[0-9]{2}-[0-9]{2} [0-9]{2}:[0-9]{2}:[0-9]{2}/)){var c=b.split(g),d=c[1].split(i),e=c[0].split(h),f=e[0],j=e[1]-1,k=e[2],l=d[0],m=d[1],n=d[2],o=new Date(f,j,k,l,m,n);return o}return Date.parse(b)}}},"1.0.0",{})