YUI.add("gallery-dp-datalist-plugin-editing",function(d){var b=d.Node,c=d.ClassNameManager.getClassName;function a(e){a.superclass.constructor.apply(this,arguments);}d.mix(a,{NS:"editing",NAME:"datalistEditing",ATTRS:{strings:{value:{add:"Add an item"}}}});d.extend(a,d.Plugin.Base,{initializer:function(e){this.afterHostEvent("render",this._renderEditingTools);this.afterHostMethod("_renderItems",this._repositionEditingTools);this.publish("add",{defaultFn:this._defFnAdd});},destructor:function(){},_renderEditingTools:function(){var f=this.get("host").get("contentBox"),e=d.Node.create(d.substitute(this.ITEM_ADD_TEMPLATE,{className:this.get("host").getClassName("add"),label:this.get("strings.add"),wrapperClassName:this.get("host").getClassName("add","wrapper"),id:d.guid()})),g=e.one("span");this._phlistitem=e;f.append(e);g.plug(d.DP.EditablePlugin,{submitto:d.bind(this._createItemFromPlaceholder,this),loadfrom:function(h){return"";}});g.editable.on("save",d.bind(this._newItemSaved,this));this._placeholder=g;f.plug(d.DP.EditablePlugin,{delegate:"."+this.get("host").getClassName("item"),event:"dblclick",loadfrom:function(h){return h.one("a").get("textContent");},submitto:d.bind(function(h,i){console.log(h.get("id"));var j=this.get("host").get("models").getByClientId(h.get("id"));j.set("title",h.one("input").get("value"));j.save(function(l,k){i();});},this)});},_repositionEditingTools:function(){this.get("host").get("contentBox").append(this._phlistitem);},_renderAddControl:function(e){return d.substitute(e.template,e);},_handleRemoveItemClicked:function(f){this.remove(f.target);},_newItemSaved:function(f){this._placeholder.editable.clear();},_createItemFromPlaceholder:function(e,g){var f=this.get("host").get("models").add({title:e.one("input").get("value")});f.save(d.bind(function(h,i){g();this.fire("add",{model:f});},this));},_defFnAdd:function(f){this._repositionEditingTools();this.get("host").set("selection",[f.model]);},ITEM_ADD_TEMPLATE:'<li class="{className}" id="{id}"><span class="{wrapperClassName}"></span></li>',_placeholder:null,_phlistitem:null});d.namespace("DP").DatalistEditing=a;},"@VERSION@",{requires:["plugin","substitute","json-parse","gallery-dp-datalist","gallery-dp-editable"]});