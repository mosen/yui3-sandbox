YUI.add("gallery-dp-datalist-plugin-editing",function(a){function d(a){d.superclass.constructor.apply(this,arguments)}var b=a.Node,c=a.ClassNameManager.getClassName;a.mix(d,{NS:"editing",NAME:"datalistEditing",ATTRS:{strings:{value:{tooltip:"Add an item",placeholder:"Add an item",cancel:"Cancel",submit:"OK",indicator:"Saving..."}},fnDefaultText:{value:function(a){return""},validator:a.Lang.isFunction}}}),a.extend(d,a.Plugin.Base,{initializer:function(a){this.afterHostEvent("render",this._renderEditingTools),this.afterHostMethod("_renderItems",this._repositionEditingTools),this.publish("add",{defaultFn:this._defFnAdd})},destructor:function(){},_renderEditingTools:function(){var b=this.get("host").get("contentBox"),c=a.Node.create(a.substitute(this.ITEM_ADD_TEMPLATE,{className:this.get("host").getClassName("add"),label:this.get("strings.add"),wrapperClassName:this.get("host").getClassName("add","wrapper"),id:a.guid()})),d=c.one("span");this._phlistitem=c,b.append(c),d.plug(a.DP.EditablePlugin,{submitto:a.bind(this._fnCreateListItem,this),loadfrom:this.get("fnDefaultText"),strings:this.get("strings"),select:!0}),d.editable.on("save",a.bind(this._onItemCreated,this)),this._placeholder=d,b.plug(a.DP.EditablePlugin,{delegate:"."+this.get("host").getClassName("item"),event:"dblclick",loadfrom:function(a){return a.one("a").get("textContent")},submitto:a.bind(this._fnUpdateListItem,this),select:!0})},_repositionEditingTools:function(){this.get("host").get("contentBox").append(this._phlistitem)},_handleRemoveItemClicked:function(a){this.remove(a.target)},_onItemCreated:function(a){this._placeholder.editable.clear()},_fnCreateListItem:function(a,b){var c=this.get("host").get("models"),d=this,e=new c.model({title:a.one("input").get("value")});c.add(e),e.save({},function(a,c){b(a),d.fire("add",{model:e})})},_fnUpdateListItem:function(a,b){var c=this.get("host").get("models").getByClientId(a.get("id"));c.set("title",a.one("input").get("value")),c.save(function(a,c){b(a,c)})},_defFnAdd:function(a){this._repositionEditingTools(),this.get("host").set("selection",[a.model])},ITEM_ADD_TEMPLATE:'<li class="{className}" id="{id}"><span class="{wrapperClassName}"></span></li>',_placeholder:null,_phlistitem:null}),a.namespace("DP").DatalistEditing=d},"1.0.0",{})