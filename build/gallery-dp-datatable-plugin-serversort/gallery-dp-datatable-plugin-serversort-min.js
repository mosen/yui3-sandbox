YUI.add("gallery-dp-datatable-plugin-serversort",function(a){var g=a.Lang,h=a.ClassNameManager.getClassName,i="datatable",k="column",c="asc",f="desc",e=1001,b=1002,d=1000,j='<a class="{link_class}" title="{link_title}" href="{link_href}">{value}</a>';a.namespace("DP").DataTableServerSort=a.Base.create("gallery-dp-datatable-plugin-serversort",a.Plugin.Base,[],{initializer:function(m){var n=this.get("host"),l=n.datasource;this.beforeHostMethod("_createTheadThNode",this._beforeCreateTheadThNode,this);this.beforeHostMethod("_attachTheadThNode",this._beforeAttachTheadThNode,this);this.beforeHostMethod("_attachTbodyTdNode",this._beforeAttachTbodyTdNode,this);n.delegate("click",a.bind(this._handleHeaderClick,this),"th");this.publish("sort",{defaultFn:this._uiSetSort});},destructor:function(){},_beforeCreateTheadThNode:function(l){if(l.column.get("sortable")){l.value=a.substitute(this.get("template"),{link_class:l.link_class||"",link_title:l.column.get("title")||l.column.get("key"),link_href:"#",value:l.value});}},_beforeAttachTheadThNode:function(q){var p=this.get("lastSortedBy"),n=p&&p.key,l=p&&p.dir,m=p&&p.notdir;if(q.column.get("sortable")){q.th.addClass(h(i,"sortable"));}if(n&&(n===q.column.get("key"))){q.th.replaceClass(h(i,m),h(i,l));}},_beforeAttachTbodyTdNode:function(q){var p=this.get("lastSortedBy"),n=p&&p.key,l=p&&p.dir,m=p&&p.notdir;if(q.column.get("sortable")){q.td.addClass(h(i,"sortable"));}if(n&&(n===q.column.get("key"))){q.td.replaceClass(h(i,m),h(i,l));}},_handleHeaderClick:function(n){n.halt();var m=this.get("host"),l=m.get("columnset").idHash[n.currentTarget.get("id")];if(l.get("sortable")){this.sort(l);}},sort:function(m,l){var o=this.get("sorting"),n=m.get("id"),p=o[n];if(l!==undefined){o[m.get("id")]=l;}else{if(p===undefined||p===d){o[n]=e;}else{if(p===e){o[n]=b;}else{if(p===b){o[n]=d;}}}}this.fire("sort",{column:m,direction:o[n]});},_uiSetSort:function(m){var l=m.column.thNode;switch(m.direction){case e:l.removeClass(h(i,f));l.addClass(h(i,c));break;case b:l.removeClass(h(i,c));l.addClass(h(i,f));break;default:l.removeClass(h(i,f));l.removeClass(h(i,c));}},getQueryParameters:function(){var l=this.get("sorting"),m=[];for(key in l){m.push(key);m.push(l[key]);}}},{NS:"sort",ATTRS:{sorting:{value:[]},template:{value:j}}});},"@VERSION@",{requires:["datatable","datatable-datasource"]});