YUI.add("gallery-dp-datalist",function(c){var a=c.Node,b=c.ClassNameManager.getClassName;c.namespace("DP").DataList=c.Base.create("gallery-dp-datalist",c.Widget,[],{initializer:function(d){this.publish("select");},_renderItems:function(f){var d=c.bind(this.get("fnRender"),this),e=this.get("contentBox");f.each(function(g){e.append(this._renderItem(d,{value:g,id:g.get("clientId")}));},this);},_renderItem:function(d,e){return c.Node.create(c.substitute(this.LISTITEM_TEMPLATE,{content:d(e.value),className:this.getClassName("item"),wrapperClassName:this.getClassName("wrapper"),id:e.id||c.guid()}));},bindUI:function(){this.after("selectionChange",this._uiSetSelected,this);this.get("models").after("add",this._uiAddItem,this);this.get("models").after("remove",this._uiRemoveItem,this);this.get("models").after("reset",this._uiSetItems,this);this.get("models").on("*:change",this._uiUpdateItems,this);this.get("contentBox").delegate("click",c.bind(this._handleItemClicked,this),"."+this.getClassName("item"));},syncUI:function(){},destructor:function(){this.get("contentBox").detach("click");},_handleItemClicked:function(h){var f=h.currentTarget,d=f.get("id"),g=this.get("models").getByClientId(d);this.set("selection",[g]);},_uiSetItems:function(d){var f=this.get("models");this.get("contentBox").all("."+this.getClassName("item")).remove();this._renderItems(f);this._uiSetSelected();},_uiAddItem:function(h){var g=h.model,f,d=this.get("fnRender");f=this._renderItem(c.bind(d,this),{value:g,id:g.get("clientId")});this.get("contentBox").append(f);},_uiRemoveItem:function(h){var f=this.get("selection"),g=f.indexOf(h.model),d;if(g>-1){d=[this.get("models").item(this.get("models").size()-1)];this.set("selection",d);}this.get("contentBox").one("#"+h.model.get("clientId")).remove();},_uiUpdateItems:function(h){var d,g,f,e=h.target;if(h.changed.hasOwnProperty("title")){d=c.bind(this.get("fnRender"),this),g=this._renderItem(d,{value:e,id:e.get("clientId")});f=this.get("contentBox").one("li#"+e.get("clientId"));f.replace(g);}},_uiRemoveItems:function(d){},_uiSetSelected:function(h){var f=this.get("selection"),g=this.get("contentBox"),d;g.all("."+this.getClassName("item","selected")).removeClass(this.getClassName("item","selected"));c.Array.each(f,function(e){d=e.get("clientId");this.fire("select",{itemid:d,item:e});g.one("#"+d).addClass(this.getClassName("item","selected"));},this);},ITEM_TEMPLATE:'<a href="#{anchor}">{title}</a>',LISTITEM_TEMPLATE:'<li class="{className}" id="{id}">{content}</li>',CONTENT_TEMPLATE:"<ul></ul>"},{NAME:"datalist",HTML_PARSER:{},ATTRS:{models:{value:null},fnRender:{value:function(d){return c.substitute(this.ITEM_TEMPLATE,{className:this.getClassName("item"),anchor:d["id"],title:d["title"]});},validator:c.Lang.isFunction},selection:{value:[],validator:c.Lang.isArray},selectNewItems:{value:true,validator:c.Lang.isBoolean}}});},"@VERSION@",{requires:["widget","datasource","recordset"]});