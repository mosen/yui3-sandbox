YUI.add("gallery-dp-datalist",function(c){var a=c.Node,b=c.ClassNameManager.getClassName;c.namespace("DP").DataList=c.Base.create("gallery-dp-datalist",c.Widget,[],{initializer:function(d){this.publish("success",{defaultFn:this._defResponseSuccessFn});this.publish("select");this._ioCallback={complete:c.bind(this._handleResponse,this,"complete"),success:c.bind(this._handleResponse,this,"success"),failure:c.bind(this._handleResponse,this,"failure"),end:c.bind(this._handleResponse,this,"end")};},_renderItems:function(e){var d=c.bind(this.get("fnRender"),this),f=this.get("contentBox");e.each(function(g){f.append(this._renderItem(d,{value:g.get("data"),id:g.get("id")}));},this);},_renderItem:function(d,e){return c.Node.create(c.substitute(this.LISTITEM_TEMPLATE,{content:d(e.value),className:this.getClassName("item"),wrapperClassName:this.getClassName("wrapper"),id:e.id||c.guid()}));},bindUI:function(){this.after("recordsetChange",this._uiSetItems,this);this.after("selectionChange",this._uiSetSelected,this);this.get("contentBox").delegate("click",c.bind(this._handleItemClicked,this),"."+this.getClassName("item"));},syncUI:function(){this.get("source").sendRequest({request:this.get("initialRequest"),callback:this._ioCallback});},destructor:function(){this.get("contentBox").detach("click");},_handleResponse:function(d,f){this.fire(d,{id:this._io,response:f.response});this._io=null;},_defResponseSuccessFn:function(d){this.set("recordset",new c.Recordset({records:d.response.results}));},_handleItemClicked:function(i){var d=i.currentTarget,h=d.get("id"),f=this.get("recordset").getRecord(h),g;if(undefined==f){this.get("recordset")._setHashTable();}g=f.getValue();this.set("selection",["#"+h]);this.fire("select",{itemid:h,item:g});},_uiSetItems:function(f){var d=f.newVal;this.get("contentBox").all("."+this.getClassName("item")).remove();this._renderItems(d);this._uiSetSelected();},_uiSetSelected:function(g){var d=this.get("selection"),f=this.get("contentBox");f.all("."+this.getClassName("item","selected")).removeClass(this.getClassName("item","selected"));f.all(d.join(",")).addClass(this.getClassName("item","selected"));},_ioCallback:{},ITEM_TEMPLATE:'<a href="#{anchor}">{title}</a>',LISTITEM_TEMPLATE:'<li class="{className}" id="{id}">{content}</li>',CONTENT_TEMPLATE:"<ul></ul>"},{NAME:"datalist",HTML_PARSER:{},ATTRS:{source:{value:null},recordset:{value:null},fnRender:{value:function(d){return c.substitute(this.ITEM_TEMPLATE,{className:this.getClassName("item"),anchor:d["id"],title:d["title"]});},validator:c.Lang.isFunction},selection:{value:[],validator:c.Lang.isArray}}});},"@VERSION@",{requires:["widget","datasource","recordset"]});