YUI.add("gallery-dp-editable",function(c){var g=c.Lang,d=c.ClassNameManager.getClassName,a=d("gallery","dp","editable"),b=a+"-form",h=a+"-input",f=a+"-submit",j=a+"-cancel",e=a+"-placeholder";function i(){this.publish("afterSave",{defaultFn:this._defFnAfterSave});this.publish("afterCancel",{defaultFn:this._defFnAfterCancel});}c.mix(i,{NAME:"editableBase",ATTRS:{strings:{value:{tooltip:"Click to edit...",cancel:"Cancel",submit:"OK",indicator:"Saving...",placeholder:"Click to edit..."}},targetnode:{value:null},editingnode:{value:null},event:{value:"click"},prevContent:{value:null},type:{value:"text",validator:"_validateAttrType"},rows:{value:null},cols:{value:null},submitto:{value:null},fnGetSubmitParameters:{value:function(l,k){}},method:{value:"POST"},loadfrom:{value:null},fnNodeToEditor:{value:function(k){return k.get("textContent");}},fnEditorToNode:{value:function(k){return k.get("value");}},editing:{value:false},select:{value:false},inputWidth:{value:"auto"},inputHeight:{value:"auto"},onblur:{value:"cancel"},delegate:{value:null}}});i.prototype={destructor:function(){this.get("targetnode").detach(this.get("event"));},_bindEditableBase:function(){if(null==this.get("delegate")){this.get("targetnode").on(this.get("event"),c.bind(this._onClick,this));}else{this.get("targetnode").delegate(this.get("event"),this._onClick,this.get("delegate"),this);}},_syncEditableBase:function(){var k;if(null==this.get("delegate")){k=this.get("editingnode");}else{k=this.get("targetnode").all(this.get("delegate"));}k.set("title",this.get("strings.tooltip"));},_validateAttrType:function(k){return("textarea"==k||"text"==k||"select"==k)?true:false;},_onClick:function(k){k.halt();if(this._input==k.target){return false;}if(this.get("editingnode")!==null&&this.get("editingnode")!==k.currentTarget){this.save();}this.set("editingnode",k.currentTarget);this.startEditor();},_onClickCancel:function(k){k.stopPropagation();this.discard();},_onClickSave:function(k){k.stopPropagation();this.save();},_defFnAfterSave:function(k){this.requestSave(k.value);},_defFnAfterCancel:function(){},startEditor:function(){if(true==this.get("editing")){return false;}var n=this._renderForm(),o=this.get("inputWidth"),m=this.get("inputHeight"),l=this.get("editingnode"),p,k=this.get("loadfrom");this.set("prevContent",l.get("innerHTML"));p=this.get("fnNodeToEditor")(l);l.set("innerHTML","");l.append(n);this._input.set("value",p);this._input.focus();if(true==this.get("select")){this._input.select();}this.set("editing",true);},_renderForm:function(){var l=this.get("type"),o=c.Node.create(c.substitute(this.TEMPLATE_FORM,{className:b})),k,n,p=this.get("inputWidth"),m=this.get("inputHeight");switch(l){case"textarea":k=c.Node.create(c.substitute(this.TEMPLATE_INPUT_TEXTAREA,{className:h}));if(this.get("rows")!==null){k.setAttribute("rows",this.get("rows"));}if(this.get("cols")!==null){k.setAttribute("cols",this.get("cols"));}break;case"select":k=c.Node.create(c.substitute(this.TEMPLATE_INPUT_SELECT,{className:h}));break;case"text":default:k=c.Node.create(c.substitute(this.TEMPLATE_INPUT_TEXT,{className:h}));break;}if(p!=="auto"){k.setStyle("width",p);}if(m!=="auto"){k.setStyle("height",m);}this._input=k;o.append(this._input);n=c.Node.create(c.substitute(this.TEMPLATE_BUTTONS,{classNameSubmit:f,classNameCancel:j,labelSubmit:this.get("strings.submit"),labelCancel:this.get("strings.cancel")}));n.one("."+j).on("click",this._onClickCancel,this);n.one("."+f).on("click",this._onClickSave,this);o.append(n);return o;},save:function(){var l=this.get("editingnode"),k=this._input.get("value");l.set("innerHTML","");l.append(this.get("fnEditorToNode")(this._input));this.set("prevContent",null);this.set("editingnode",null);this.set("editing",false);this.fire("afterSave",{value:k});},requestSave:function(l){var k=this.get("submitto");if(c.Lang.isString(k)){c.io(c.substitute(k,{value:l}),{on:{start:this._saveStart,success:this._saveSuccess,failure:this._saveFailure},context:this});}else{if(c.Lang.isFunction(k)){k();}}},discard:function(){var k=this.get("editingnode");k.set("innerHTML",this.get("prevContent"));this.set("prevContent",null);this.set("editingnode",null);this.set("editing",false);this.fire("afterCancel");},_onKey:function(){},TEMPLATE_FORM:'<form class="{className}"></form>',TEMPLATE_INPUT_TEXT:'<input type="text" class="{className}"></input>',TEMPLATE_INPUT_TEXTAREA:'<textarea class="{className}"></textarea>',TEMPLATE_INPUT_SELECT:'<select class="{className}"></select>',TEMPLATE_BUTTONS:'<input type="button" value="{labelCancel}" class="{classNameCancel}"></input><input type="button" value="{labelSubmit}" class="{classNameSubmit}"></input>',TEMPLATE_PLACEHOLDER:'<span class="{className}">{text}</span>',_input:null};c.namespace("DP").EditableBase=i;EditablePlugin=c.Base.create("editablePlugin",c.Plugin.Base,[c.DP.EditableBase],{initializer:function(k){this.set("targetnode",k.host);if(!k.delegate){this.set("editingnode",k.host);}this._bindEditableBase();this._syncEditableBase();}},{NS:"editable",NAME:"editable"});c.namespace("DP").EditablePlugin=EditablePlugin;},"@VERSION@",{requires:["base","plugin","io"]});