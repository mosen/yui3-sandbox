YUI.add("gallery-dp-timeline-plugin-insertion",function(c){var b=c.Lang,a=c.Node;c.namespace("DP").TimelineInsertion=c.Base.create("gallery-dp-timeline-plugin-insertion",c.Plugin.Base,[],{initializer:function(d){this.afterHostMethod("render",this.renderUI);this.afterHostMethod("bindUI",this.bindUI);},renderUI:function(){this.set("insertionNode",this._renderBackgroundInsertionHighlight());this.get("insertionNode").on("click",c.bind(this.onInsertionClick,this));this.get("host")._nodeBackgroundContainer.append(this.get("insertionNode"));},bindUI:function(){this.get("host")._nodeBackgroundContainer.on("mousemove",c.bind(this.onBackgroundHover,this));},destructor:function(){},_renderBackgroundInsertionHighlight:function(){var d=a.create(c.substitute(this.get("tplBackgroundInsertionHighlight"),{className:this.get("host").getClassName("background","hlinsert"),tipClassName:this.get("host").getClassName("background","hlinsert","tip"),tip:this.get("strings.tip")}));d.set("width",this.get("host").get("dayWidth"));return d;},onBackgroundHover:function(h){var j,g,f=this.get("host").get("contentBox").get("offsetLeft"),d=h.clientX-f;for(g=0;g<this.get("host")._dates.length;g++){j=Math.abs(d-this.get("host")._dates[g].mid);if(j<(this.get("host").get("dayWidth")/2)){this.get("insertionNode").set("style.left",this.get("host")._dates[g].leftLocal+"px");this.set("hoverDate",this.get("host")._dates[g].date);}}},onInsertionClick:function(g){var f=this.get("childPrototype"),d=this.get("hoverDate");f.start=d;f.finish=d;var h=this.get("host").add(f);h.item(0).set("selected",1);}},{NS:"insertion",ATTRS:{tplBackgroundInsertionHighlight:{value:'<div class="{className}"><div class="{tipClassName}">&nbsp;</div></div>'},insertionNode:{value:undefined},hoverDate:{value:Date()},childPrototype:{readonly:true,getter:function(){return{start:this.get("date"),finish:this.get("date"),summary:"Title",category:"booked"};}},strings:{value:{"tip":"Click to add event"}}}});},"@VERSION@",{requires:["base","plugin","gallery-dp-timeline"]});